{"openapi":"3.1.0","info":{"title":"Quantera API","version":"1.0.0","description":"Quantera API documentations"},"servers":[{"description":"Local server"}],"paths":{"/":{"get":{"summary":"Welcome message","description":"Returns a welcome message for the QuanteraAI API.","responses":{"200":{"description":"A welcome message.","content":{"text/plain":{"schema":{"type":"string","example":"Welcome to quanteraAi api's"}}}}}}},"/health":{"get":{"summary":"Health Check","description":"Basic health check endpoint.","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":{"type":"string"},"type":"object","title":"Response Health Check Health Get"}}}}}}},"/auth/login":{"post":{"summary":"Login with Google or Discord","description":"Authenticate a user using Google or Discord OAuth2 based on the authProvider parameter.","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginRequest"}}}},"responses":{"200":{"description":"Successful authentication","content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginResponse"}}}},"401":{"$ref":"#/components/responses/Unauthorized"},"500":{"description":"Internal server error"}}}},"/auth/password":{"post":{"summary":"Request a password reset","description":"Sends a password reset email to the user based on their email address.","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForgotPasswordRequest"}}}},"responses":{"200":{"description":"Successful operation","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForgotPasswordResponse"}}}},"400":{"description":"Invalid email or user not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForgotPasswordResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForgotPasswordResponse"}}}}}}},"/auth/reset":{"post":{"summary":"Reset user password","description":"Resets the password for a user based on the provided encrypted user ID and new password.","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResetPasswordRequest"}}}},"responses":{"200":{"description":"Successful operation","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResetPasswordResponse"}}}},"400":{"description":"Invalid data or user not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResetPasswordResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResetPasswordResponse"}}}}}}},"/accounts/{id}/status":{"get":{"summary":"Change account verification status","description":"Updates the account verification status to 'ACTIVE' for the user with the provided encrypted user ID.","parameters":[{"in":"path","name":"id","required":true,"description":"The encrypted ID of the user whose account status is to be updated.","schema":{"type":"string","example":"encryptedUserIdWithSpaces"}}],"responses":{"200":{"description":"Successful operation","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChangeAccountStatusResponse"}}}},"400":{"description":"Invalid data or user not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChangeAccountStatusResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChangeAccountStatusResponse"}}}}}}},"/accounts/{user_id}/status":{"get":{"summary":"Get account verification status","description":"Retrieves the account verification status for the user with the provided user ID.","parameters":[{"in":"path","name":"user_id","required":true,"description":"The user ID for which the account verification status is to be retrieved.","schema":{"type":"string","example":"userId123"}}],"responses":{"200":{"description":"Successful operation","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","description":"Indicates if there was an error.","example":false},"message":{"type":"string","description":"Success message.","example":"Account Status get successfully"},"body":{"$ref":"#/components/schemas/AccountVerificationStatusResponse"}}}}}},"400":{"description":"Invalid user ID or user not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/companies":{"post":{"summary":"Add new company data to the database","description":"Fetches company data from an external API and inserts it into the companies table in the database.","requestBody":{"required":false,"content":{"application/json":{"schema":{"type":"object","properties":{"page_length":{"type":"integer","description":"Number of records to fetch. Use -1 to fetch all records.","example":-1},"page_number":{"type":"integer","description":"Page number for pagination.","example":0},"search_query":{"type":"string","description":"Search term for filtering results.","example":"tech"}}}}}},"responses":{"200":{"description":"Company data inserted successfully","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"company data inserted successfully"},"body":{"type":"object","description":"Details of the insertion operation.","example":{}}}}}}},"400":{"description":"Bad request or invalid parameters","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"Invalid request parameters"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"An error occurred while inserting company data."},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}}}},"patch":{"summary":"Update sector and ETF deletion status","description":"Updates the deletion status for ETFs and sectors in the database. ETFs that were marked as deleted will be undeleted, and sectors marked as active will be marked as deleted.","parameters":[{"in":"query","name":"sector","schema":{"type":"boolean","enum":[true,false],"example":true}}],"responses":{"200":{"description":"Status updated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"Companies status updated successfully"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}},"500":{"description":"Error updating sector or ETF status","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"Error code"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}}}}},"/users":{"post":{"summary":"Register a new user","description":"Register a new user by providing email, first name, last name, and password.","requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"email":{"type":"string","example":"user@example.com"},"firstName":{"type":"string","example":"John"},"lastName":{"type":"string","example":"Doe"},"password":{"type":"string","example":"password123"}}}}}},"responses":{"200":{"description":"User registered successfully","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean"},"msg":{"type":"string"},"body":{"type":"array","items":{"type":"object"}}}}}}},"500":{"description":"Internal server error"}}}},"/users/{id}/profile":{"post":{"summary":"Submit user information","description":"Submits user information and sends an email upon successful submission.","parameters":[{"in":"path","name":"id","required":true,"description":"The ID of the user to retrieve information for.","schema":{"type":"string","example":"12345"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AboutYouRequest"}}}},"responses":{"200":{"description":"Successful operation","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AboutYouResponse"}}}},"400":{"description":"Invalid input or user has already filled information","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AboutYouResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AboutYouResponse"}}}}}},"get":{"summary":"Get user information","description":"Retrieves user information based on the provided ID.","parameters":[{"in":"path","name":"id","required":true,"description":"The ID of the user to retrieve information for.","schema":{"type":"string","example":"12345"}}],"responses":{"200":{"description":"Successful operation","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetAboutYouResponse"}}}},"400":{"description":"Invalid ID or other bad request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetAboutYouResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetAboutYouResponse"}}}}}}},"/chats":{"post":{"summary":"Create a new chat","description":"Creates a new chat entry in the database with the provided details.","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateChatRequest"}}}},"responses":{"200":{"description":"Chat created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateChatResponse"}}}},"400":{"description":"Invalid request data","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateChatResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateChatResponse"}}}}}}},"/chats/{id}/history":{"post":{"summary":"Create a new chat history entry","description":"Inserts a new chat history entry into the database with the provided details.","parameters":[{"in":"path","name":"id","required":true,"description":"Chat ID for which history is to be fetched.","schema":{"type":"string","example":"VXZ123"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateChatHistoryRequest"}}}},"responses":{"200":{"description":"Chat history created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateChatHistoryResponse"}}}},"400":{"description":"Invalid request data","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateChatHistoryResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateChatHistoryResponse"}}}}}}},"/companies/{company_symbol}/users/{user_id}/chats":{"get":{"summary":"Retrieve chats by company symbol and user ID","description":"Fetches chat entries that match the specified company symbol and user ID.","parameters":[{"in":"path","name":"company_symbol","required":true,"schema":{"type":"string"},"description":"The symbol representing the company.","example":"EX"},{"in":"path","name":"user_id","required":true,"schema":{"type":"string"},"description":"The ID of the user associated with the chat.","example":"userId123"}],"responses":{"200":{"description":"Chats fetched successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetChatsResponse"}}}},"400":{"description":"Invalid request data","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetChatsResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetChatsResponse"}}}}}}},"/users/{user_id}/chats":{"get":{"summary":"Fetch the latest chat by user ID","description":"Fetches the latest chat for a user based on the provided user ID, ordered by creation date.","parameters":[{"in":"path","name":"user_id","required":true,"schema":{"type":"integer","example":1},"description":"The unique ID of the user whose latest chat is to be fetched.","example":"userId123"}],"responses":{"200":{"description":"Latest chat fetched successfully","content":{"application/json":{"schema":{"$ref":"#/components/responses/LatestChatSuccess"}}}},"400":{"description":"Invalid request data","content":{"application/json":{"schema":{"$ref":"#/components/responses/LatestChatSuccess"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/responses/LatestChatSuccess"}}}}}}},"/chat-history":{"get":{"summary":"Retrieve all chat history","description":"Fetches all chat history entries, ordered by the creation date in descending order.","responses":{"200":{"description":"All chat history fetched successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetAllChatHistoryResponse"}}}},"400":{"description":"Invalid request data","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetAllChatHistoryResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetAllChatHistoryResponse"}}}}}}},"/chats/{chat_id}/history":{"get":{"summary":"Retrieve chat history by chat ID","description":"Fetches chat history entries associated with a specific chat ID, including company details.","parameters":[{"in":"path","name":"chat_id","required":true,"description":"The unique ID of the chat to retrieve history for.","schema":{"type":"string","example":"uuidv4-chat-id"}}],"responses":{"200":{"description":"Chat history fetched successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetChatHistoryByChatIdResponse"}}}},"400":{"description":"Invalid request data","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetChatHistoryByChatIdResponse"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetChatHistoryByChatIdResponse"}}}}}}},"/chats/{chat_id}":{"delete":{"summary":"Soft delete chats by chat ID","description":"Marks a chat and its associated history as deleted by setting the `is_deleted` field to '1'.","parameters":[{"name":"chat_id","in":"path","required":true,"description":"The unique ID of the chat to be deleted.","schema":{"type":"string","example":"uuidv4-chat-id"}}],"responses":{"200":{"description":"Chat deleted successfully","content":{"application/json":{"schema":{"$ref":"#/components/responses/ChatDeletionSuccess"}}}},"400":{"description":"Invalid request data","content":{"application/json":{"schema":{"$ref":"#/components/responses/ChatDeletionSuccess"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/responses/ChatDeletionSuccess"}}}}}}},"/companies/{company_symbol}/prompts":{"get":{"summary":"Retrieve popular prompts for a given company","description":"Fetches popular prompts for the specified company symbol.","parameters":[{"in":"path","name":"company_symbol","schema":{"type":"string"},"required":true,"description":"The symbol of the company (e.g., AAPL for Apple, GOOGL for Google)","example":"AAPL"}],"responses":{"200":{"description":"Popular prompts retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"array","description":"List of popular prompts","items":{"type":"object","properties":{"prompt":{"type":"string","example":"What are Apple's revenue streams?"},"usage_count":{"type":"integer","example":128}}}}}}}}},"400":{"description":"Invalid company symbol provided","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Invalid company symbol."}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"An error occurred."}}}}}}}}},"/users/{user_id}":{"get":{"summary":"Retrieve details for a specific user","description":"Fetches detailed information about the user identified by the provided user ID.","parameters":[{"in":"path","name":"user_id","schema":{"type":"string"},"required":true,"description":"The unique ID of the user","example":"60d5ec49e13e5a3cd090f792"}],"responses":{"200":{"description":"User details retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"success":{"type":"boolean","example":true},"data":{"type":"object","description":"The user details","properties":{"id":{"type":"string","example":"60d5ec49e13e5a3cd090f792"},"name":{"type":"string","example":"John Doe"},"email":{"type":"string","example":"john.doe@example.com"},"role":{"type":"string","example":"Admin"},"createdAt":{"type":"string","format":"date-time","example":"2021-06-25T10:21:15.000Z"}}}}}}}},"400":{"description":"Invalid user ID provided","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"Invalid user ID."}}}}}},"404":{"description":"User not found","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"User not found."}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","properties":{"message":{"type":"string","example":"An error occurred."}}}}}}}},"put":{"summary":"Update user profile information","description":"Updates the profile information for a specified user.","parameters":[{"in":"path","name":"user_id","required":true,"schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"user_id":{"type":"string","description":"The unique ID of the user whose profile is to be updated.","example":"user_123456"},"firstName":{"type":"string","description":"The new first name of the user.","example":"John"},"lastName":{"type":"string","description":"The new last name of the user.","example":"Doe"}}}}}},"responses":{"200":{"description":"User profile updated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"profile updated successfully"},"body":{"type":"object","description":"Details of the update operation.","example":{}}}}}}},"400":{"description":"Invalid request or parameters","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"Invalid request parameters"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}},"404":{"description":"User not found","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"no user found"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"An error occurred while updating the profile."},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}}}}},"/subscriptions":{"get":{"summary":"Retrieve available subscription plans","description":"Fetches all products and associated plans from Stripe, sorts the plans by amount, and formats the plan amounts.","responses":{"200":{"description":"Plans retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"get plans successfully"},"body":{"type":"array","description":"List of products and their associated plans","items":{"type":"object","properties":{"id":{"type":"string","description":"Product ID","example":"prod_123456"},"name":{"type":"string","description":"Product name","example":"Premium Plan"},"plans":{"type":"array","description":"Associated subscription plans for the product","items":{"type":"object","properties":{"id":{"type":"string","description":"Plan ID","example":"plan_789012"},"product":{"type":"string","description":"Product ID the plan is associated with","example":"prod_123456"},"amount":{"type":"string","description":"Formatted amount in USD","example":"$19.99"},"currency":{"type":"string","description":"Currency code","example":"usd"},"interval":{"type":"string","description":"Billing interval (e.g., monthly, yearly)","example":"month"},"interval_count":{"type":"integer","description":"Number of intervals between payments","example":1},"nickname":{"type":"string","description":"Name of the plan","example":"Basic Monthly Plan"},"active":{"type":"boolean","description":"Whether the plan is active","example":true}}}}}}}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"An error occurred while fetching the plans."},"body":{"type":"array","example":[]}}}}}}}}},"/subscriptions/{plan_id}/payments":{"post":{"summary":"Handle subscription payments and initiate Stripe checkout session","description":"This API handles user subscription payments, calculates discounts, checks for referral users, and initializes a Stripe checkout session.","parameters":[{"in":"path","name":"plan_id","required":true,"schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","required":["user_id","plan_id","planName","duration","unitAmount","total_hits"],"properties":{"user_id":{"type":"string","description":"The ID of the user making the subscription","example":"60f7a3c9d3f4567e4b1c9d2a"},"plan_id":{"type":"string","description":"The Stripe pricing plan ID","example":"price_1HQ1iJ2eZvKYlo2CQvJcA3"},"planName":{"type":"string","description":"The name of the subscription plan","example":"Basic Monthly Plan"},"duration":{"type":"string","enum":["MONTH","YEAR"],"description":"Duration of the subscription (MONTH or YEAR)","example":"MONTH"},"unitAmount":{"type":"number","description":"Unit amount of the subscription in cents (e.g., 5000 for $50)","example":5000},"total_hits":{"type":"integer","description":"The total number of API hits allowed by the plan","example":100}}}}}},"responses":{"200":{"description":"Stripe checkout session created successfully","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"Payment url initialized"},"body":{"type":"string","example":"https://checkout.stripe.com/pay/cs_test_a1b2c3d4e5f6","description":"Stripe checkout URL for payment"}}}}}},"400":{"description":"Invalid or missing input","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"Missing required parameters"},"body":{"type":"array","example":[]}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"Internal server error"},"body":{"type":"array","example":[]}}}}}}}}},"/users/{user_id}/subscriptions":{"get":{"summary":"Retrieve the active subscription for a specific user","description":"Fetches the most recent active subscription details for the specified user.","parameters":[{"in":"path","name":"user_id","schema":{"type":"string"},"required":true,"description":"The unique ID of the user for whom to retrieve the active subscription.","example":"user_123456"}],"responses":{"200":{"description":"Active subscription retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"user subscription data get successfully"},"body":{"type":"array","items":{"type":"object","properties":{"subscription_id":{"type":"string","example":"sub_123456"},"user_id":{"type":"string","example":"user_123456"},"plan_name":{"type":"string","example":"Premium Plan"},"status":{"type":"string","example":"active"},"customer_id":{"type":"string","example":"cus_123456"},"sub_id":{"type":"string","example":"sub_789101"},"order_id":{"type":"string","example":"order_123456"},"plan_id":{"type":"string","example":"plan_123456"},"duration":{"type":"integer","example":30},"price":{"type":"number","format":"float","example":99.99},"total_hits":{"type":"integer","example":100},"used_hits":{"type":"integer","example":20},"remaining_hits":{"type":"integer","example":80},"start_date":{"type":"string","format":"date-time","example":"2024-08-01T00:00:00Z"},"end_date":{"type":"string","format":"date-time","example":"2024-08-31T23:59:59Z"}}}}}}}}},"400":{"description":"Invalid user ID provided","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"Invalid user ID."},"body":{"type":"array","example":[],"items":{"type":"string","example":[]}}}}}}},"404":{"description":"No active subscription found for the user","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"No active subscription found"},"body":{"type":"array","example":[],"items":{"type":"string","example":[]}}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"An error occurred while retrieving subscription data."},"body":{"type":"array","example":[],"items":{"type":"string","example":[]}}}}}}}}},"put":{"summary":"Upgrade an existing subscription for a user","description":"Handles upgrading a user's subscription by cancelling the existing subscription and creating a new one with the selected plan.","parameters":[{"in":"path","name":"user_id","schema":{"type":"string"},"required":true}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"user_id":{"type":"string","description":"The unique ID of the user whose subscription is to be upgraded.","example":"user_123456"},"plan_ids":{"type":"string","description":"The ID of the new plan to upgrade to.","example":"plan_789101"},"amount":{"type":"number","format":"float","description":"The amount to be paid for the new subscription.","example":49.99},"planName":{"type":"string","description":"The name of the new plan.","example":"Premium Plan"},"duration":{"type":"string","description":"The duration of the subscription (e.g., \"MONTH\", \"YEAR\").","example":"YEAR"},"unitAmount":{"type":"number","format":"float","description":"The unit amount for the subscription.","example":499.99},"remaining_hits":{"type":"integer","description":"The number of remaining hits for the subscription.","example":50}}}}}},"responses":{"200":{"description":"Subscription upgrade process initiated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"Payment url initialized"},"body":{"type":"string","description":"The URL to complete the payment.","example":"https://checkout.stripe.com/pay/cs_test_123456"}}}}}},"400":{"description":"Invalid request or parameters","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"Invalid request parameters"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}},"404":{"description":"No active subscription found or subscription expired","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"No active subscription found or Subscription has expired"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"An error occurred while upgrading the subscription."},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}}}}},"/orders/{id}/payments/{payment_id}":{"get":{"summary":"Handle successful payments","description":"This endpoint is triggered after a successful Stripe payment to update the payment and subscription status.","parameters":[{"in":"path","name":"id","description":"The unique order ID associated with the payment","schema":{"type":"string"},"required":true,"example":"order_12345"},{"in":"path","name":"payment_id","schema":{"type":"string"},"required":true,"description":"The unique payment session ID from Stripe","example":"cs_test_a1b2c3d4e5"},{"in":"query","name":"status","schema":{"type":"string","enum":["success","failed","pending","cancelled"]},"description":"Filter subscriptions by their status."}],"responses":{"200":{"description":"Payment and subscription successfully updated","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"Payment successful"},"body":{"type":"array","example":[]}}}}}},"400":{"description":"Payment failed or invalid order ID","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"payment failed"},"body":{"type":"array","example":[]}}}}}},"404":{"description":"Unknown order ID","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"unknown order_id"},"body":{"type":"array","example":[]}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"An error occurred while processing the payment."},"body":{"type":"array","example":[]}}}}}}}}},"/orders/{id}/payments/{payment_id}/cancel":{"get":{"summary":"Handle payment cancellation","description":"This endpoint is triggered when a payment is canceled to update the payment and subscription status.","parameters":[{"in":"path","name":"id","schema":{"type":"string"},"required":true,"description":"The unique order ID associated with the payment","example":"order_54321"},{"in":"path","name":"payment_id","schema":{"type":"string"},"required":true,"description":"The unique payment session ID from Stripe","example":"cs_test_a1b2c3d4e5"}],"responses":{"200":{"description":"Payment and subscription successfully canceled","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"Payment canceled"},"body":{"type":"array","example":[]}}}}}},"400":{"description":"Invalid request or payment ID","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"Invalid payment ID"},"body":{"type":"array","example":[]}}}}}},"404":{"description":"Unknown order ID","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"unknown order_id"},"body":{"type":"array","example":[]}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"An error occurred while canceling the payment."},"body":{"type":"array","example":[]}}}}}}}}},"/users/{user_id}/subscriptions/cancel":{"get":{"summary":"Cancel a user's subscription","description":"Cancels the active subscription for the specified user and updates the subscription status in the database.","parameters":[{"in":"path","name":"user_id","schema":{"type":"string"},"required":true,"description":"The unique ID of the user"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"user_id":{"type":"string","description":"The ID of the user whose subscription needs to be canceled.","example":"user_123456"}}}}}},"responses":{"200":{"description":"Subscription canceled successfully","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"subscription cancelled successfully"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}},"400":{"description":"User not found or subscription cannot be canceled","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"user not found"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"An error occurred while canceling the subscription."},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}}}}},"/users/{id}/subscriptions/free":{"get":{"summary":"Retrieve subscription status for a user","description":"Gets the check status of a user's subscription based on the provided user ID.","parameters":[{"name":"id","in":"path","required":true,"description":"The ID of the user whose subscription status is to be retrieved.","schema":{"type":"integer","example":123}}],"responses":{"200":{"description":"Successfully retrieved the subscription status","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"success"},"body":{"type":"array","items":{"type":"object","properties":{"check_status":{"type":"string","example":"active"}}}}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"SQL error code"},"msg":{"type":"string","example":"Error message"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}}}},"post":{"summary":"Update subscription status to free for a user","description":"Updates the `check_status` field to '1' (indicating a free subscription) for the user with the specified ID.","parameters":[{"name":"id","in":"path","required":true,"description":"The ID of the user whose subscription status is to be updated.","schema":{"type":"integer","example":123}}],"responses":{"200":{"description":"Successfully updated the subscription status","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"success"},"body":{"type":"object","additionalProperties":true}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"SQL error code"},"msg":{"type":"string","example":"Error message"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}}}}},"/markOldDataAsDeleted":{"get":{"summary":"Mark old data as deleted in the stockscreener table","description":"Updates records in the `stockscreener` table to mark data as deleted if the timestamp is older than 3 hours.","responses":{"200":{"description":"Old data marked as deleted successfully","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"old data deleted successfully"},"body":{"type":"object","description":"Details of the update operation.","example":{}}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"An error occurred while marking old data as deleted."},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}}}}},"/users/{user_id}/stock-screeners":{"get":{"summary":"Get stock screener data with pagination and search","description":"Retrieves a list of stock screener data with options for pagination and search. Also includes information about whether each stock is marked as a favorite.","parameters":[{"name":"user_id","in":"path","required":true,"description":"The ID of the user to check for favorite stocks.","schema":{"type":"integer","example":123}},{"name":"page","in":"query","required":false,"description":"Page number for pagination (defaults to 1).","schema":{"type":"integer","example":1}},{"name":"limit","in":"query","required":false,"description":"Number of records per page (defaults to 50).","schema":{"type":"integer","example":50}},{"name":"searchStr","in":"query","required":false,"description":"Search string to filter the stock screener data by stock name.","schema":{"type":"string","example":"Tesla"}}],"responses":{"200":{"description":"Successfully retrieved stock screener data","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"stock screener data get successfully"},"total_length":{"type":"integer","example":100},"body":{"type":"array","items":{"type":"object","properties":{"symbol":{"type":"string","example":"AAPL"},"name":{"type":"string","example":"Apple Inc."},"company_market_cap":{"type":"string","example":"2.48T"},"is_favorite":{"type":"integer","example":1}}}}}}}}},"400":{"description":"Bad request, invalid query parameters","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"Invalid query parameters"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"SQL error code"},"msg":{"type":"string","example":"Error message"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}}}}},"/stock-screeners":{"get":{"summary":"Retrieve and update stock screener data","description":"Fetches all company data to update the stock screener. Pagination options are available but not required.","parameters":[{"name":"page","in":"query","required":false,"description":"Page number for pagination (defaults to 1).","schema":{"type":"integer","example":1}},{"name":"limit","in":"query","required":false,"description":"Number of records per page (defaults to 500).","schema":{"type":"integer","example":500}},{"name":"deleted","in":"query","required":false,"description":"Indicate if only non-deleted data should be fetched.","schema":{"type":"integer","example":0}}],"responses":{"200":{"description":"Successfully retrieved and updated stock screener data","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"Stock screener data retrieved successfully"},"body":{"type":"array","items":{"type":"object","properties":{"symbol":{"type":"string","example":"AAPL"},"name":{"type":"string","example":"Apple Inc."},"company_market_cap":{"type":"string","example":"2.48T"},"logo":{"type":"string","example":"http://example.com/logo.png"}}}}}}}}},"400":{"description":"Bad request, invalid query parameters","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"Invalid query parameters"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"string","example":"Error message"},"msg":{"type":"string","example":"Error message"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}}}}},"/updateRequestlimit":{"get":{"summary":"Update the request limit for API keys","description":"Updates the `remaining_requests` field of all non-deleted API keys to 800.","responses":{"200":{"description":"Successfully updated the request limit for API keys","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"keys request limit updated successfully"},"body":{"type":"object","properties":{"affectedRows":{"type":"integer","example":10}}}}}}}},"400":{"description":"Bad request, potential issues with API key data","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"api_keys not found"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"Error code or message"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}}}}},"/stocks":{"get":{"summary":"Search stocks with filters","description":"Retrieves stocks from the `stockscreener` table based on search and filter criteria including market cap and price changes.","parameters":[{"name":"searchStr","in":"query","description":"Search term for stock name or symbol","required":false,"schema":{"type":"string","example":"Apple"}},{"name":"price_type","in":"query","description":"Filter by price change percentage","required":false,"schema":{"type":"string","example":"5"}},{"name":"market_cap_type","in":"query","description":"Filter by market capitalization type","required":false,"schema":{"type":"string","enum":["mega_cap","large_cap","mild_cap","small_cap","micro_cap"],"example":"large_cap"}}],"responses":{"200":{"description":"Successfully retrieved stock screener data","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"Stock screener data retrieved successfully"},"body":{"type":"array","items":{"type":"object","properties":{"id":{"type":"integer","example":1},"name":{"type":"string","example":"Apple Inc."},"symbol":{"type":"string","example":"AAPL"},"company_market_cap":{"type":"string","example":"2230000000000"},"change_percent":{"type":"string","example":"1.5"},"is_favorite":{"type":"integer","example":0}}}}}}}}},"400":{"description":"Bad request, invalid parameters","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"Invalid parameters"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"Error code or message"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}}}}},"/updateCompanyStatus":{"get":{"summary":"Update company and stock screener statuses","description":"Marks companies as active if they were previously deleted and marks stocks as deleted if they were previously active.","responses":{"200":{"description":"Successfully updated company and stock screener statuses","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"Companies status updated successfully"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"Error code or message"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}}}}},"/updateScreenStatus":{"get":{"summary":"Update screen statuses for companies and stocks","description":"Marks companies as active if they were previously deleted and marks stocks as deleted if they were previously active.","responses":{"200":{"description":"Successfully updated screen statuses","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"Screen status updated successfully"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"Error code or message"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}}}}},"/tokens/{user_id}":{"put":{"summary":"Update token usage for a user","description":"Increments the used hits for the active subscription of the specified user. Returns an error if no active subscription is found or if there are no remaining hits.","parameters":[{"in":"path","name":"user_id","required":true,"schema":{"type":"integer"},"description":"The ID of the user whose token usage is to be updated."}],"responses":{"200":{"description":"Token updated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"message":{"type":"string","example":"Token updated successfully"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}},"400":{"description":"No active subscription found or no remaining hits available","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"message":{"type":"string","example":"No active subscription found or No remaining hits available. Please upgrade your plan."},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"message":{"type":"string","example":"Error message"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}}}}},"/sendQuery":{"post":{"summary":"Send a query email","description":"Sends a query email to a specified recipient with the provided questions and subject. Encrypts the user ID before sending the email.","requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"userId":{"type":"integer","example":123,"description":"The ID of the user sending the query."},"questions":{"type":"string","example":"What is the status of my subscription?","description":"The questions to be sent in the query."},"subject":{"type":"string","example":"Subscription Inquiry","description":"The subject of the query email."}}}}}},"responses":{"200":{"description":"Query email sent successfully","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"Query sent successfully"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}},"400":{"description":"No user found or error sending email","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"No user found or Error sending email"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"Error message"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}}}}},"/companies/{company_symbol}/users/{user_id}/favourite":{"patch":{"summary":"Update or insert favorite status for a company","description":"Updates the favorite status for a company for a specific user. If a record already exists, it will be updated; otherwise, a new record will be inserted.","parameters":[{"in":"path","name":"company_symbol","required":true,"schema":{"type":"integer"},"description":"The symbol of the company."},{"in":"path","name":"user_id","required":true,"schema":{"type":"integer"},"description":"The ID of the user whose company favourite is to be updated."}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","properties":{"status":{"type":"boolean","example":true,"description":"The favorite status (true for favorite, false for not favorite)."}}}}}},"responses":{"200":{"description":"Favorite status updated or inserted successfully","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"Favorite status updated successfully or Favorite status inserted successfully"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}},"400":{"description":"Error updating or inserting favorite status","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"Error code"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}}}}},"/getSectorscreener":{"get":{"summary":"Retrieve sector screener data","description":"Fetches sector screener data along with related chat summaries.","responses":{"200":{"description":"Sector screener data retrieved successfully","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"Sector screener data received successfully"},"data":{"type":"array","description":"Organized sector screener data based on time series","items":{"type":"object","properties":{"name":{"type":"string","example":"Technology"},"time_series":{"type":"array","items":{"type":"object","properties":{"timestamp":{"type":"string","example":"2024-09-01T12:00:00Z"},"value":{"type":"number","example":150.75}}}}}}},"prompt":{"type":"string","description":"Chat summary about the sector screener","example":"The technology sector has shown significant growth in the last quarter."}}}}}},"500":{"description":"Error retrieving sector screener data","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"Error code"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}}}}},"/updateSectorscreener":{"get":{"summary":"Update sector screener data","description":"Retrieves and updates sector screener data with new trends and summary information.","parameters":[{"in":"query","name":"page","schema":{"type":"integer","example":1},"description":"The page number for pagination (optional)."},{"in":"query","name":"limit","schema":{"type":"integer","example":500},"description":"The number of records per page for pagination (optional)."}],"responses":{"200":{"description":"Sector screener data updated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"Sector screener data retrieved and updated successfully"},"body":{"type":"array","description":"The response body containing the updated sector data.","items":{"type":"object","properties":{"name":{"type":"string","example":"Technology"},"time_series":{"type":"array","description":"The time series data for the sector.","items":{"type":"object","properties":{"timestamp":{"type":"string","example":"2024-09-01T12:00:00Z"},"value":{"type":"number","example":150.75}}}}}}}}}}}},"500":{"description":"Error updating sector screener data","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"Error message"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}}}}},"/config/query/{kind}":{"patch":{"summary":"Update mixpanel daily analytic data","description":"Retrieves and updates mix panel data with new trends and summary information.","parameters":[{"in":"path","name":"kind","required":true,"schema":{"type":"string","enum":["daily","weekly","monthly"],"example":"daily"},"description":"The page number for pagination (optional)."},{"in":"query","name":"page","schema":{"type":"integer","example":1},"description":"The page number for pagination (optional)."},{"in":"query","name":"limit","schema":{"type":"integer","example":500},"description":"The number of records per page for pagination (optional)."}],"responses":{"200":{"description":"Mixpanel data updated successfully","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":false},"msg":{"type":"string","example":"Mixpanel data updated successfully"},"body":{"type":"array","description":"The response body containing the updated sector data.","items":{"type":"object","properties":{"name":{"type":"string","example":"Technology"},"time_series":{"type":"array","description":"The time series data for the sector.","items":{"type":"object","properties":{"timestamp":{"type":"string","example":"2024-09-01T12:00:00Z"},"value":{"type":"number","example":150.75}}}}}}}}}}}},"500":{"description":"Error updating daily mixpanel data","content":{"application/json":{"schema":{"type":"object","properties":{"error":{"type":"boolean","example":true},"msg":{"type":"string","example":"Error message"},"body":{"type":"array","items":{"type":"string","example":[]}}}}}}}}}},"/api/v1/generate_plot":{"post":{"summary":"Generate Plot","description":"Generate a plot based on a question-answer pair.\n\nArgs:\n    request: FastAPI Request object\n    plot_request: PlotRequest model containing question and answer\n    settings: Application settings\n    \nReturns:\n    PlotResponse containing the generated plot and metadata\n    \nRaises:\n    HTTPException: If plot generation fails or invalid input is provided","operationId":"generate_plot_api_v1_generate_plot_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PlotRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PlotResponse"}}}},"400":{"description":"Bad Request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}},"500":{"description":"Internal Server Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/api/v1/health":{"get":{"summary":"Health Check","description":"Simple health check endpoint.\n\nReturns:\n    Dict containing status message","operationId":"health_check_api_v1_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":{"type":"string"},"type":"object","title":"Response Health Check Api V1 Health Get"}}}}}}},"/api/v1/costs":{"get":{"summary":"Get Costs","description":"Get current token costs for the service.\n\nArgs:\n    settings: Application settings\n    \nReturns:\n    Dict containing token costs","operationId":"get_costs_api_v1_costs_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":{"type":"number"},"type":"object","title":"Response Get Costs Api V1 Costs Get"}}}}}}},"/api/v1/preview_plot":{"post":{"summary":"Preview Plot","description":"Generate and return a preview of the plot as standalone HTML.\n\nArgs:\n    plot_request: PlotRequest model containing question and answer\n    \nReturns:\n    HTML string containing the plot preview\n    \nRaises:\n    HTTPException: If plot generation fails","operationId":"preview_plot_api_v1_preview_plot_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PlotRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"text/html":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"ForgotPasswordRequest":{"type":"object","properties":{"email":{"type":"string","description":"The email address of the user requesting a password reset.","example":"user@example.com"}}},"ForgotPasswordResponse":{"type":"object","properties":{"error":{"type":"boolean","description":"Indicates if there was an error.","example":false},"message":{"type":"string","description":"Success or error message.","example":"Email sent successfully"},"body":{"type":"object","description":"Response body.","example":{}}}},"ResetPasswordRequest":{"type":"object","properties":{"_id":{"type":"string","description":"Encrypted user ID.","example":"encryptedUserId"},"password":{"type":"string","description":"The new password for the user.","example":"newPassword123"}}},"ResetPasswordResponse":{"type":"object","properties":{"error":{"type":"boolean","description":"Indicates if there was an error.","example":false},"message":{"type":"string","description":"Success or error message.","example":"Password updated successfully"},"body":{"type":"object","description":"Response body.","example":{}}}},"ChangeAccountStatusRequest":{"type":"object","properties":{"id":{"type":"string","description":"Encrypted user ID.","example":"encryptedUserIdWithSpaces"}}},"ChangeAccountStatusResponse":{"type":"object","properties":{"error":{"type":"boolean","description":"Indicates if there was an error.","example":false},"message":{"type":"string","description":"Success or error message.","example":"Account status updated successfully."},"body":{"type":"object","description":"Response body.","example":{}}}},"AccountVerificationStatusResponse":{"type":"object","properties":{"email_status":{"type":"string","description":"The account verification status of the user.","example":"ACTIVE"}}},"ErrorResponse":{"properties":{"error":{"type":"string","title":"Error","description":"Error type"},"detail":{"type":"string","title":"Detail","description":"Error description"},"request_id":{"type":"string","title":"Request Id","description":"Unique request identifier"}},"type":"object","required":["error","detail","request_id"],"title":"ErrorResponse","description":"Standard error response model"},"CreateChatRequest":{"type":"object","properties":{"company_name":{"type":"string","description":"The name of the company for the chat.","example":"Example Company"},"company_logo":{"type":"string","description":"URL of the company logo.","example":"https://example.com/logo.png"},"user_id":{"type":"string","description":"ID of the user creating the chat.","example":"userId123"},"title":{"type":"string","description":"Title of the chat.","example":"Customer Support"},"company_symbol":{"type":"string","description":"Symbol representing the company.","example":"EX"}}},"CreateChatResponse":{"type":"object","properties":{"error":{"type":"boolean","description":"Indicates if there was an error.","example":false},"message":{"type":"string","description":"Success or error message.","example":"Chat created successfully"},"body":{"type":"object","description":"Response body containing the chat ID.","properties":{"chat_id":{"type":"string","description":"The unique ID of the created chat.","example":"uuidv4-chat-id"}}}}},"LoginRequest":{"type":"object","properties":{"authProvider":{"type":"string","description":"The authentication provider (e.g., 'google' or 'discord').","example":"google"},"code":{"type":"string","description":"The authorization code received from the provider.","example":"4/abcd1234"}}},"LoginResponse":{"type":"object","properties":{"token":{"type":"string","description":"The JWT token issued upon successful authentication.","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"}}},"AboutYouRequest":{"type":"object","properties":{"userId":{"type":"string","description":"The ID of the user.","example":"12345"},"closestOption":{"type":"string","description":"User's closest option.","example":"Option1"},"frequency":{"type":"string","description":"Frequency of user preferences.","example":"Daily"},"frequencyAmount":{"type":"integer","description":"Amount associated with frequency.","example":5},"investMarket":{"type":"array","items":{"type":"string"},"description":"Markets the user is interested in.","example":["Stock","Crypto"]},"investSector":{"type":"array","items":{"type":"string"},"description":"Sectors the user is interested in.","example":["Technology","Finance"]}}},"AboutYouResponse":{"type":"object","properties":{"error":{"type":"boolean","description":"Indicates if there was an error.","example":false},"msg":{"type":"string","description":"Error message or success message.","example":"Email sent successfully."},"body":{"type":"array","description":"Response body.","example":[]}}},"GetAboutYouResponse":{"type":"object","properties":{"error":{"type":"boolean","description":"Indicates if there was an error.","example":false},"msg":{"type":"string","description":"Success or error message.","example":"Success"},"body":{"type":"array","items":{"type":"object","properties":{"id":{"type":"integer","description":"Unique identifier for the record.","example":1},"closestOption":{"type":"string","description":"User's closest option.","example":"Option1"},"frequency":{"type":"string","description":"Frequency of user preferences.","example":"Daily"},"frequencyAmount":{"type":"integer","description":"Amount associated with frequency.","example":5},"investMarket":{"type":"array","items":{"type":"string"},"description":"Markets the user is interested in.","example":["Stock","Crypto"]},"investSector":{"type":"array","items":{"type":"string"},"description":"Sectors the user is interested in.","example":["Technology","Finance"]}}}}}},"CreateChatHistoryRequest":{"type":"object","properties":{"chat_id":{"type":"string","description":"The ID of the chat associated with the history.","example":"uuidv4-chat-id"},"question":{"type":"string","description":"The question asked in the chat.","example":"What is your return policy?"},"answer":{"type":"string","description":"The answer provided in the chat.","example":"You can return items within 30 days of purchase."},"is_processed":{"type":"boolean","description":"Indicates whether the chat history entry has been processed.","example":true},"source_page":{"type":"string","description":"The source page where the chat occurred.","example":"FAQ page"},"document_url":{"type":"string","description":"URL to any related document.","example":"https://example.com/return-policy.pdf"}}},"CreateChatHistoryResponse":{"type":"object","properties":{"error":{"type":"boolean","description":"Indicates if there was an error.","example":false},"message":{"type":"string","description":"Success or error message.","example":"Chat history created successfully"},"body":{"type":"array","description":"Empty array indicating successful creation.","example":[]}}},"Chat":{"type":"object","properties":{"chat_id":{"type":"string","description":"The unique ID of the chat.","example":"uuidv4-chat-id"},"company_name":{"type":"string","description":"The name of the company for the chat.","example":"Example Company"},"company_logo":{"type":"string","description":"URL of the company logo.","example":"https://example.com/logo.png"},"user_id":{"type":"string","description":"ID of the user associated with the chat.","example":"userId123"},"title":{"type":"string","description":"Title of the chat.","example":"Customer Support"},"company_symbol":{"type":"string","description":"Symbol representing the company.","example":"EX"},"is_deleted":{"type":"string","description":"Status indicating whether the chat is deleted.","example":"0"}}},"GetChatsResponse":{"type":"object","properties":{"error":{"type":"boolean","description":"Indicates if there was an error.","example":false},"message":{"type":"string","description":"Success or error message.","example":"Chats fetched successfully"},"body":{"type":"array","items":{"$ref":"#/components/schemas/Chat"},"description":"List of chats matching the criteria.","example":[]}}},"GetAllChatsResponse":{"type":"object","properties":{"error":{"type":"boolean","description":"Indicates if there was an error.","example":false},"message":{"type":"string","description":"Success or error message.","example":"All chats fetched successfully."},"body":{"type":"array","items":{"$ref":"#/components/schemas/Chat"},"description":"List of chats for the specified user.","example":[]}}},"ChatHistory":{"type":"object","properties":{"chat_id":{"type":"string","description":"The unique ID of the chat.","example":"uuidv4-chat-id"},"question":{"type":"string","description":"The question asked in the chat.","example":"What are the store hours?"},"answer":{"type":"string","description":"The answer provided in the chat.","example":"Our store hours are from 9 AM to 9 PM."},"is_processed":{"type":"string","description":"Indicates if the chat has been processed.","example":"0"},"source_page":{"type":"string","description":"The source page where the chat originated.","example":"Home Page"},"document_url":{"type":"string","description":"URL of any associated document.","example":"https://example.com/document.pdf"},"created_at":{"type":"string","format":"date-time","description":"The date and time when the chat history entry was created.","example":"2024-09-13T12:34:56Z"}}},"GetAllChatHistoryResponse":{"type":"object","properties":{"error":{"type":"boolean","description":"Indicates if there was an error.","example":false},"message":{"type":"string","description":"Success or error message.","example":"Chat history fetched successfully"},"body":{"type":"array","items":{"$ref":"#/components/schemas/ChatHistory"},"description":"List of chat history entries.","example":[]}}},"ChatHistoryByChatId":{"type":"object","properties":{"chat_id":{"type":"string","description":"The unique ID of the chat.","example":"uuidv4-chat-id"},"question":{"type":"string","description":"The question asked in the chat.","example":"What are the store hours?"},"answer":{"type":"string","description":"The answer provided in the chat.","example":"Our store hours are from 9 AM to 9 PM."},"is_processed":{"type":"string","description":"Indicates if the chat has been processed.","example":"0"},"source_page":{"type":"string","description":"The source page where the chat originated.","example":"Home Page"},"document_url":{"type":"string","description":"URL of any associated document.","example":"https://example.com/document.pdf"},"created_at":{"type":"string","format":"date-time","description":"The date and time when the chat history entry was created.","example":"2024-09-13T12:34:56Z"},"company_name":{"type":"string","description":"The name of the company.","example":"Tech Innovations"},"company_symbol":{"type":"string","description":"The symbol representing the company.","example":"TI"},"company_logo":{"type":"string","description":"URL of the company logo.","example":"https://example.com/logo.png"}}},"GetChatHistoryByChatIdResponse":{"type":"object","properties":{"error":{"type":"boolean","description":"Indicates if there was an error.","example":false},"message":{"type":"string","description":"Success or error message.","example":"Chats by chat Id fetched successfully"},"body":{"type":"array","items":{"$ref":"#/components/schemas/ChatHistoryByChatId"},"description":"List of chat history entries with company details.","example":[]}}},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"PlotRequest":{"properties":{"question":{"type":"string","maxLength":1000,"minLength":3,"title":"Question","example":"How has CrowdStrike's revenue grown over the past 5 years?"},"answer":{"type":"string","maxLength":4000,"minLength":10,"title":"Answer","example":"CrowdStrike's revenue has grown significantly: 2019: $250M, 2020: $481M, 2021: $874M, 2022: $1.45B, 2023: $2.24B"},"viz_type":{"anyOf":[{"$ref":"#/components/schemas/VisualizationType"},{"type":"null"}],"description":"Visualization library to use","default":"d3"}},"type":"object","required":["question","answer"],"title":"PlotRequest","description":"Request model for plot generation"},"PlotResponse":{"properties":{"is_plot_needed":{"type":"boolean","title":"Is Plot Needed","description":"Indicates whether a plot can be generated for the given Q&A"},"plot_html":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Plot Html","description":"Generated HTML/JS code for the visualization"},"plot_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Plot Type","description":"Type of plot that was generated (e.g., 'line', 'bar')"},"tokens_used":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Tokens Used","description":"Number of tokens used in LLM API calls"},"cost":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Cost","description":"Total cost of LLM API calls in USD"}},"type":"object","required":["is_plot_needed"],"title":"PlotResponse","description":"Response model for plot generation","example":{"cost":0.025,"is_plot_needed":true,"plot_html":"<div id='chart'>...</div>","plot_type":"line","tokens_used":1250}},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"VisualizationType":{"type":"string","enum":["d3","chartjs"],"title":"VisualizationType","description":"Supported visualization library types"}},"securitySchemes":{"bearerAuth":{"type":"http","scheme":"bearer","bearerFormat":"JWT"}}},"tags":[]}